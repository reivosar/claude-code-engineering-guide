# システム設計

## 概要

要件定義を基に、システムの技術的な設計を行うフェーズです。アーキテクチャ、データベース設計、API設計等を決定します。

## 設計プロセス

### 1. アーキテクチャ設計

```markdown
## システムアーキテクチャ

### 全体構成
- **Frontend**: React + TypeScript
- **Backend**: Node.js/Spring Boot
- **Database**: PostgreSQL
- **Infrastructure**: AWS/GCP

### アーキテクチャパターン
- **MVCパターン**: 責任分離
- **マイクロサービス**: 独立性確保
- **イベント駆動**: 疎結合実現
```

### 2. データベース設計

```sql
-- ユーザーテーブル例
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    name VARCHAR(100) NOT NULL,
    role user_role NOT NULL DEFAULT 'user',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- インデックス設計
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_created_at ON users(created_at);
```

### 3. API設計

```yaml
# OpenAPI仕様例
openapi: 3.0.0
info:
  title: User Management API
  version: 1.0.0

paths:
  /api/v1/users:
    post:
      summary: ユーザー作成
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                name:
                  type: string
                password:
                  type: string
                  minLength: 8
      responses:
        '201':
          description: ユーザー作成成功
        '400':
          description: バリデーションエラー
```

### 4. セキュリティ設計

```markdown
## セキュリティアーキテクチャ

### 認証・認可
- **JWT認証**: ステートレス認証
- **リフレッシュトークン**: 長期認証
- **RBAC**: ロールベースアクセス制御

### データ保護
- **暗号化**: 保存時・通信時
- **入力検証**: 全入力値の検証
- **SQLインジェクション対策**: パラメータ化クエリ
```

## Claude Codeでの設計支援

### アーキテクチャ設計の依頼

```
「以下の要件に基づいて、システムアーキテクチャを設計してください。

要件:
- ECサイト構築
- 月間10万PV
- モバイル対応必須
- 決済機能必要

求める成果:
1. システム構成図
2. 技術スタック選定理由
3. スケーラビリティ考慮点
4. セキュリティ対策」
```

### データベース設計の依頼

```
「以下のエンティティ関係を基に、正規化されたDB設計を提案してください。

エンティティ:
- ユーザー
- 商品
- 注文
- 支払い

要件:
- ACID特性保証
- パフォーマンス最適化
- 将来の拡張性考慮」
```

### API設計の依頼

```
「RESTful APIを設計してください。

対象: ブログシステム
機能:
- 記事CRUD
- コメント機能
- ユーザー管理

設計原則:
- RESTful
- バージョニング対応
- エラーハンドリング統一
- ドキュメント自動生成」
```

---
[← 01. 要件定義](../01.requirements/01.requirements-definition.md) | [03. 開発 →](../03.development/01.coding-standards.md)